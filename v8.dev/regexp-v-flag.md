---
origin: https://v8.dev/features/regexp-v-flag
date: 2022-10-06 13:21:48
---

## RegExp çš„ `v` æ ‡è®°ï¼Œè®¾ç½®æ–¹å¼ï¼Œä»¥åŠå­—ç¬¦ä¸²ç›¸å…³å±æ€§

JavaScript ä» ECMAScript3(1999 å¹´) å¼€å§‹æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚16 å¹´ä¹‹åï¼ŒES2015 ä»‹ç»äº† [Unicode æ¨¡å¼ï¼ˆ`u` æ ‡å¿—ï¼‰][unicode mode]ã€[sticky æ¨¡å¼ï¼ˆ`y` æ ‡å¿—ï¼‰][sticky mode]ï¼Œä»¥åŠ [`RegExp.prototype.flags` getter][flags getter]ã€‚åˆè¿‡äº†ä¸‰å¹´ï¼ŒES2018 ä»‹ç»äº†
[`dotAll` æ¨¡å¼ï¼ˆ`s` æ ‡å¿—ï¼‰][dotall mode]ã€[åè¡Œæ–­è¨€][lookbehind assertions]ã€[å…·åæ•è·ç»„][named capture groups]ï¼Œä»¥åŠ [Unicode å­—ç¬¦ä¸²å±æ€§è½¬ä¹‰][unicode escapes]ã€‚åœ¨ ES2020ï¼Œ[`String.prototype.matchAll`][match all] è®©æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨èµ·æ¥å˜å¾—æ›´åŠ ç®€å•ã€‚JavaScript æ­£åˆ™è¡¨è¾¾å¼å·²ç»èµ°äº†å¾ˆé•¿ä¸€æ®µè·¯ï¼Œå¹¶ä»ç„¶åœ¨ä¸æ–­æ”¹è¿›ä¸­ã€‚

æœ€æ–°çš„ä¾‹å­æ¼”ç¤ºäº† [æ–°çš„ `unicodeSets` æ¨¡å¼ï¼Œç”¨ `v` æ ‡å¿—å¼€å¯][regexp v proposal]ã€‚è¿™ç§æ–°çš„æ¨¡å¼è§£é”äº†å¯¹æ–°çš„å­—ç¬¦é›†çš„æ”¯æŒï¼ŒåŒ…å«å¦‚ä¸‹åŠŸèƒ½ï¼š

<!-- prevent markdown-all-in-one auto update toc -->

- ` `
- [å­—ç¬¦ä¸²çš„ Unicode å±æ€§](#å­—ç¬¦ä¸²çš„-unicode-å±æ€§)
- [è®¾ç½®ç¬¦å· + å­—ç¬¦ä¸²å­—é¢é‡è¯­æ³•](#è®¾ç½®ç¬¦å·--å­—ç¬¦ä¸²å­—é¢é‡è¯­æ³•)
- [æ”¹è¿›ä¸åŒºåˆ†å¤§å°å†™çš„åŒ¹é…](#ignorecase)

è¿™ç¯‡æ–‡ç« å°†æ·±å…¥ç ”ç©¶ä»¥ä¸Šé—®é¢˜ï¼Œä½†æœ€é‡è¦çš„æ˜¯ --- å¦‚ä½•ä½¿ç”¨æ–°çš„æ ‡è®°ï¼š

```ts
const re = /.../v;
```

`v` æ ‡è®°å¯ä»¥å’Œå·²å­˜åœ¨çš„æ­£åˆ™è¡¨è¾¾å¼çš„æ ‡è®°ä¸€èµ·æ··ç”¨ï¼Œä½†æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ä¾‹å¤–ã€‚`v` æ ‡è®°å¯ç”¨äº† `u` æ ‡è®°ä¸­æ‰€æœ‰å¥½çš„éƒ¨åˆ†ï¼Œä½†ä¹Ÿå¸¦æœ‰é¢å¤–çš„åŠŸèƒ½å’Œæ”¹è¿› ---
å…¶ä¸­ä¸€äº›å’Œ `u` æ ‡å¿—ä¸å‘åå…¼å®¹ã€‚å…³é”®æ˜¯ï¼Œ`v` å’Œ `u` æ˜¯å®Œå…¨ç‹¬ç«‹çš„æ¨¡å¼ï¼Œè€Œä¸æ˜¯äº’è¡¥çš„å…³ç³»ã€‚å› æ­¤ï¼Œ`v` å’Œ `u` ä¸èƒ½åŒæ—¶ä½¿ç”¨ --- å°è¯•åŒæ—¶ä½¿ç”¨
ä¸¤ä¸ªæ ‡è®°åœ¨åŒä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸Šä¼šå¯¼è‡´ä¸€ä¸ªé”™è¯¯ã€‚ä»…æœ‰çš„æœ‰æ•ˆé€‰é¡¹æ˜¯ï¼šç”¨ `u` æˆ–è€…ç”¨ `v`ï¼Œæˆ–è€…æ—¢ä¸ç”¨ `u` ä¹Ÿä¸ç”¨ `v`ã€‚ä½†ç”±äº `v` æ˜¯åŠŸèƒ½å®Œæ•´çš„é€‰é¡¹ï¼Œ
æ‰€ä»¥å¾ˆå®¹æ˜“åšè¿™ä¸ªé€‰æ‹©...

è®©å’±ä»¬æ·±å…¥ç ”ç©¶æ–°çš„åŠŸèƒ½å§ï¼

## å­—ç¬¦ä¸²çš„ Unicode å±æ€§

Unicode æ ‡å‡†ä¸ºæ¯ä¸ªç¬¦å·éƒ½åˆ†é…äº†ä¸€ä¸ªå±æ€§å’Œå±æ€§å€¼ã€‚ä¾‹å¦‚ï¼Œè¦è·å¾—ç”¨åœ¨å¸Œè…Šæ–‡å­—ä¸­çš„ç¬¦å·çš„é›†åˆï¼Œåœ¨ Unicode æ•°æ®åº“ä¸­æœç´¢ç¬¦å·çš„ `Script_Extensions` å±æ€§å€¼ä¸­åŒ…å« `Greek` å³å¯ã€‚

ES2018 Unicode å­—ç¬¦ä¸²å±æ€§è½¬ä¹‰ä½¿å¾—åœ¨ ECMAScript åŸç”Ÿçš„æ­£åˆ™è¡¨è¾¾å¼ä¸­è®¿é—® Unicode å­—ç¬¦ä¸²å±æ€§æˆä¸ºå¯èƒ½ã€‚ä¾‹å¦‚ï¼Œè¡¨è¾¾å¼ `\p{Script_Extensions=Greek}` åŒ¹é…æ¯ä¸€ä¸ªç”¨åœ¨å¸Œè…Šæ–‡å­—ä¸­çš„ç¬¦å·ï¼š

```ts
const regexGreekSymbol = /\p{Script_Extensions=Greek}/u;
regexGreekSymbol.test("Ï€");
// â†’ true
```

æ ¹æ®å®šä¹‰ï¼ŒUnicode å­—ç¬¦ä¸²å±æ€§æ‰©å±•åˆ°ä¸€ç»„ä»£ç ç‚¹ï¼Œå› æ­¤å¯ä»¥è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ç±»ï¼Œå…¶ä¸­æ¯ä¸ªå­—ç¬¦ç±»å„è‡ªåŒ…å«å®ƒä»¬åŒ¹é…çš„ä»£ç ç‚¹ã€‚ä¾‹å¦‚ï¼Œ`\p{ASCII_Hex_Digit}` ç­‰æ•ˆäº `[0-9a-fA-F]`ï¼šè¿™æ¯æ¬¡ä»…èƒ½åŒ¹é…ä¸€ä¸ª
Unicode å­—ç¬¦/ä»£ç ç‚¹ï¼Œåœ¨æŸäº›æ¡ä»¶ä¸‹ï¼Œè¿™æ ·å¹¶ä¸é«˜æ•ˆã€‚

```ts
// Unicode defines a character property named â€œEmojiâ€.
const re = /^\p{Emoji}$/u;

// Match an emoji that consists of just 1 code point:
re.test("âš½"); // '\u26BD'
// â†’ true âœ…

// Match an emoji that consists of multiple code points:
re.test("ğŸ‘¨ğŸ¾â€âš•ï¸"); // '\u{1F468}\u{1F3FE}\u200D\u2695\uFE0F'
// â†’ false âŒ
```

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¸èƒ½åŒ¹é… ğŸ‘¨ğŸ¾â€âš•ï¸ è¡¨æƒ…ï¼Œå› ä¸ºå®ƒæ˜¯ç”±å¤šä¸ªä»£ç ç‚¹ç»„æˆçš„ã€‚è€Œ `Emoji` æ˜¯ä¸€ä¸ª Unicode å­—ç¬¦ä¸²å±æ€§ã€‚

å¹¸è¿çš„æ˜¯ï¼ŒUnicode æ ‡å‡†è¿˜å®šä¹‰äº†ä¸€äº›[å­—ç¬¦ä¸²å±æ€§][properties of strings]ï¼Œè¿™äº›å±æ€§æ‰©å±•æˆä¸€ç»„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­æ¯ä¸ªå­—ç¬¦ä¸²éƒ½åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªä»£ç ç‚¹ã€‚ åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå­—ç¬¦ä¸²å±æ€§ç¿»è¯‘æˆä¸€ç»„å­—ç¬¦é›†ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ª Unicode å±æ€§è¡¨ç¤ºè¿™äº›å­—ç¬¦ä¸²ï¼Œ`'a'`, `'b'`, `'c'`, `'W'`, `'xy'`, å’Œ `'xyz'`ã€‚è¿™äº›å±æ€§è½¬æ¢æˆä»¥ä¸‹æ­£åˆ™è¡¨è¾¾å¼ä¹‹ä¸€ï¼š`xyz|xy|a|b|c|W` æˆ–è€… `xyz|xy|[a-cW]`ã€‚
ï¼ˆæœ€é•¿çš„å­—ç¬¦ä¸²ä¼˜å…ˆï¼Œè¿™æ ·åƒ `xy` è¿™æ ·çš„å‰ç¼€å°±ä¸ä¼šéšè—åƒ `xyz` è¿™æ ·ä¸€ä¸ªæ›´é•¿çš„å­—ç¬¦ä¸²ã€‚ï¼‰
ä¸åƒå·²å­˜åœ¨çš„ Unicode å±æ€§è½¬ä¹‰ï¼Œè¿™ä¸ªæ¨¡å¼å¯ä»¥åŒ¹é…å¤šå­—ç¬¦ä¸²ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨å­—ç¬¦ä¸²å±æ€§çš„ä¾‹å­ï¼š

```ts
const re = /^\p{RGI_Emoji}$/v;

// Match an emoji that consists of just 1 code point:
re.test("âš½"); // '\u26BD'
// â†’ true âœ…

// Match an emoji that consists of multiple code points:
re.test("ğŸ‘¨ğŸ¾â€âš•ï¸"); // '\u{1F468}\u{1F3FE}\u200D\u2695\uFE0F'
// â†’ true âœ…
```

è¿™æ®µä»£ç ç‰‡æ®µå¼•ç”¨äº†å­—ç¬¦ä¸²å±æ€§ `RGI_Emoji`ï¼ŒUnicode å°†å…¶å®šä¹‰ä¸ºã€Œç”¨äºå¹³æ—¶äº¤æµçš„æ‰€æœ‰æœ‰æ•ˆçš„è¡¨æƒ…ç¬¦å·ï¼ˆå­—ç¬¦åºåˆ—ï¼‰ã€ã€‚æœ‰äº†è¿™ä¸ªï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥
åŒ¹é…è¡¨æƒ…ç¬¦å·ï¼Œä¸ç®¡å®ƒåŒ…å«äº†å¤šå°‘ä¸ªä»£ç ç‚¹ã€‚

`v` æ ‡è®°ä»ä¸€å¼€å§‹æ”¯æŒå¦‚ä¸‹ Unicode å­—ç¬¦ä¸²å±æ€§ï¼š

- `Basic_Emoji`
- `Emoji_Keycap_Sequence`
- `RGI_Emoji_Modifier_Sequence`
- `RGI_Emoji_Flag_Sequence`
- `RGI_Emoji_Tag_Sequence`
- `RGI_Emoji_ZWJ_Sequence`
- `RGI_Emoji`

éšç€ Unicode æ ‡å‡†å®šä¹‰å…¶ä»–çš„å­—ç¬¦ä¸²å±æ€§ï¼Œè¿™ä¸ªå—æ”¯æŒçš„åˆ—è¡¨å°†æ¥å¯èƒ½ä¼šå¢åŠ ã€‚å°½ç®¡å½“å‰å­—ç¬¦ä¸²å±æ€§éƒ½ä¸è¡¨æƒ…ç¬¦å·ç›¸å…³ï¼Œ
å°†æ¥çš„å­—ç¬¦ä¸²å±æ€§å¯èƒ½ç”¨äºå®Œå…¨ä¸åŒçš„ç”¨ä¾‹ã€‚

> æ³¨æ„ï¼šå°½ç®¡å­—ç¬¦ä¸²å±æ€§ç›®å‰å—é™äºæ–°çš„ `v` æ ‡è®°ï¼Œ[ä½†æˆ‘ä»¬è®¡åˆ’æœ€ç»ˆå°†ä½¿å®ƒåœ¨ `u` æ¨¡å¼ä¹Ÿå¯ç”¨][proposal regexp v flag]ã€‚

## è®¾ç½®ç¬¦å· + å­—ç¬¦ä¸²å­—é¢é‡è¯­æ³•

å½“ä½¿ç”¨ `\p{...}` è½¬ä¹‰ï¼ˆæ— è®ºæ˜¯å­—ç¬¦å±æ€§è¿˜æ˜¯æ–°çš„å­—ç¬¦ä¸²å±æ€§ï¼‰å®ƒå¯ä»¥æ‰§è¡Œå·®/å‡æˆ–è€…äº¤è¿ç®—ã€‚

æœ‰äº† `v` æ ‡å¿—ï¼Œå­—ç¬¦ç±»å°±å¯ä»¥åµŒå¥—äº†ï¼Œè¿™äº›é›†åˆæ“ä½œç°åœ¨å¯ä»¥åœ¨å­—ç¬¦ç±»ä¸­æ‰§è¡Œï¼Œè€Œä¸å¿…ä½¿ç”¨ç›¸é‚»çš„å‰å‘æ–­è¨€æˆ–åå‘æ–­è¨€æˆ–å†—é•¿å­—ç¬¦ç±»æ¥è¡¨ç¤ºè®¡ç®—èŒƒå›´ã€‚

### å·®/å‡ è¿ç®— `--`

è¯­æ³• `A--B` å¯ä»¥ç”¨äºåŒ¹é… A ä¸­çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ B ä¸­çš„å­—ç¬¦ä¸²ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå·®/å‡ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³è¦åŒ¹é…é™¤äº† `Ï€` ä¹‹å¤–çš„æ‰€æœ‰çš„å¸Œè…Šç¬¦å·ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿç”¨è®¾ç½®ç¬¦å·æ–¹æ³•ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜å°±å¾ˆç®€å•ï¼š

```ts
/[\p{Script_Extensions=Greek}--Ï€]/v.test("Ï€"); // â†’ false
```

ä½¿ç”¨ `--` åšå·®/å‡ è¿ç®—ï¼Œæ­£åˆ™è¡¨è¾¾å¼å¼•æ“å¸®ä½ åšäº†å¤æ‚çš„å·¥ä½œï¼ŒåŒæ—¶ä¿æŒäº†ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

å¦‚æœæˆ‘ä»¬æƒ³è¦å‡å»å­—ç¬¦é›† `Î±`, `Î²`, å’Œ `Î³` è€Œä¸æ˜¯å•ä¸ªå­—ç¬¦å‘¢ï¼Ÿæ²¡é—®é¢˜ - æˆ‘ä»¬å¯ä»¥ç”¨åµŒå¥—çš„å­—ç¬¦ç±»å¹¶å‡å»å®ƒçš„å†…å®¹ï¼š

```ts
/[\p{Script_Extensions=Greek}--[Î±Î²Î³]]/v.test("Î±"); // â†’ false
/[\p{Script_Extensions=Greek}--[Î±-Î³]]/v.test("Î²"); // â†’ false
```

å¦ä¸€ä¸ªä¾‹å­æ˜¯åŒ¹é…é ASCII æ•°å­—ï¼Œä¾‹å¦‚ç¨åå°†å®ƒä»¬è½¬æ¢æˆ ASCII æ•°å­—ï¼š

```ts
/[\p{Decimal_Number}--[0-9]]/v.test("ğ‘œ¹"); // â†’ true
/[\p{Decimal_Number}--[0-9]]/v.test("4"); // â†’ false
```

è®¾ç½®ç¬¦å·ä¹Ÿå¯ä»¥å’Œæ–°çš„å­—ç¬¦ä¸²å±æ€§ä¸€èµ·ä½¿ç”¨ï¼š

```ts
// æ³¨æ„: ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿ åŒ…å« 7 ä¸ªä»£ç ç‚¹ã€‚

/^\p{RGI_Emoji_Tag_Sequence}$/v.test("ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿"); // â†’ true
/^[\p{RGI_Emoji_Tag_Sequence}--\q{ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿}]$/v.test("ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿"); // â†’ false
```

è¿™ä¸ªä¾‹å­åŒ¹é…é™¤äº†è‹æ ¼å…°çš„å›½æ——ä¹‹å¤–çš„ä»»ä½• RGI è¡¨æƒ…ç¬¦å·æ ‡ç­¾åºåˆ—ã€‚æ³¨æ„ `\q{...}` çš„ä½¿ç”¨ï¼Œè¿™æ˜¯å­—ç¬¦ä¸²å­—é¢é‡åœ¨å­—ç¬¦ç±»é‡Œé¢çš„å¦å¤–ä¸€ç§æ–°çš„è¯­æ³•ã€‚
ä¾‹å¦‚ï¼Œ`\q{a|bc|def}` åŒ¹é…å­—ç¬¦ä¸² `a`, `bc` å’Œ `def`ã€‚å¦‚æœæ²¡æœ‰ `|q{...}`ï¼Œå®ƒå°±ä¸å¯èƒ½å‡å»ç¡¬ç¼–ç çš„å¤šå­—ç¬¦å­—ç¬¦ä¸²

### äº¤é›†å’Œ `&&`

`A&&B` çš„è¯­æ³•åŒ¹é…åŒæ—¶åœ¨ `A` å’Œ `B` ä¸­çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯äº¤é›†ã€‚è¿™è®©ä½ å¯ä»¥åšç±»ä¼¼åŒ¹é…å¸Œè…Šå­—æ¯çš„äº‹æƒ…ï¼š

```ts
const re = /[\p{Script_Extensions=Greek}&&\p{Letter}]/v;
// U+03C0 GREEK SMALL LETTER PI
re.test("Ï€"); // â†’ true
// U+1018A GREEK ZERO SIGN
re.test("ğ†Š"); // â†’ false
```

åŒ¹é…æ‰€æœ‰ ASCII ç©ºæ ¼ï¼š

```ts
const re = [\p{White_Space}&&\p{ASCII}];
re.test('\n'); // â†’ true
re.test('\u2028'); // â†’ false
```

æˆ–è€…åŒ¹é…æ‰€æœ‰è’™å¤æ•°å­—ï¼š

```ts
const re = [\p{Script_Extensions=Mongolian}&&\p{Number}];
// U+1817 è’™å¤æ•°å­— 7
re.test('á —'); // â†’ true
// U+1834 è’™å¤å­—æ¯ CHA
re.test('á ´'); // â†’ false
```

### å¹¶é›†

åŒ¹é…å•å­—ç¬¦å­—ç¬¦ä¸²å±äº `A` æˆ–è€…å±äº `B` åœ¨ä¹‹å‰å·²ç»å¯ä»¥ç”¨åƒ `[\p{Letter}\p{Number}]` è¿™æ ·çš„å­—ç¬¦ç±»ã€‚æœ‰äº† `v` æ ‡å¿—ï¼Œ
è¿™ä¸ªåŠŸèƒ½å˜å¾—æ›´åŠ å¼ºå¤§ï¼Œå› ä¸ºç°åœ¨å®ƒå¯ä»¥å’Œå­—ç¬¦ä¸²å±æ€§æˆ–è€…å­—ç¬¦ä¸²å­—é¢é‡ç»“åˆï¼š

```ts
const re = /^[\p{Emoji_Keycap_Sequence}\p{ASCII}\q{ğŸ‡§ğŸ‡ª|abc}xyz0-9]$/v;

re.test("4ï¸âƒ£"); // â†’ true
re.test("_"); // â†’ true
re.test("ğŸ‡§ğŸ‡ª"); // â†’ true
re.test("abc"); // â†’ true
re.test("x"); // â†’ true
re.test("4"); // â†’ true
```

è¯¥æ¨¡å¼ä¸­çš„å­—ç¬¦ç±»ç»„åˆä¸ºï¼š

- ä¸€ä¸ªå­—ç¬¦ä¸²å±æ€§ï¼ˆ`\p{Emoji_Keycap_Sequence}`ï¼‰
- ä¸€ä¸ªå­—ç¬¦å±æ€§ï¼ˆ`\p{ASCII}`ï¼‰
- å¤šç ç‚¹å­—ç¬¦ä¸² ğŸ‡§ğŸ‡ª å’Œ abc çš„å­—ç¬¦ä¸²å­—é¢é‡è¯­æ³•
- ç”¨äºå•ä¸ªå­—ç¬¦çš„ x, y å’Œ z çš„ç»å…¸å­—ç¬¦ç±»è¯­æ³•
- ç”¨äºå­—ç¬¦èŒƒå›´çš„ 0 åˆ° 9 çš„ç»å…¸å­—ç¬¦ç±»è¯­æ³•

<!--  -->

å¦ä¸€ä¸ªä¾‹å­æ˜¯åŒ¹é…æ‰€æœ‰å¸¸ç”¨çš„è¡¨æƒ…ç¬¦å·æ ‡å¿—ï¼Œä¸ç®¡ä»–ä»¬è¢«ç¼–ç æœªä¸¤ä¸ª ISO ä»£ç å­—ç¬¦ï¼ˆ`RGI_Emoji_Flag_Sequence`ï¼‰
è¿˜æ˜¯è¢«ç¼–ç ä¸ºä¸€ä¸ªç‰¹æ®Šå¤§å°å†™çš„åºåˆ—ï¼ˆ`RGI_Emoji_Tag_Sequence`ï¼‰ï¼š

```ts
const reFlag = /[\p{RGI_Emoji_Flag_Sequence}\p{RGI_Emoji_Tag_Sequence}]/v;
// A flag sequence, consisting of 2 code points (flag of Belgium):
re.test("ğŸ‡§ğŸ‡ª"); // â†’ true
// A tag sequence, consisting of 7 code points (flag of England):
re.test("ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿"); // â†’ true
// A flag sequence, consisting of 2 code points (flag of Switzerland):
re.test("ğŸ‡¨ğŸ‡­"); // â†’ true
// A tag sequence, consisting of 7 code points (flag of Wales):
re.test("ğŸ´ó §ó ¢ó ·ó ¬ó ³ó ¿"); // â†’ true
```

### æ”¹è¿›ä¸åŒºåˆ†å¤§å°å†™çš„åŒ¹é…

ES2015 `u` æ ‡å¿—å­˜åœ¨[æ··æ·†çš„ä¸åŒºåˆ†å¤§å°å†™åŒ¹é…è¡Œä¸º](https://github.com/tc39/proposal-regexp-v-flag/issues/30)ã€‚æ€è€ƒä»¥ä¸‹ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼š

```ts
const re1 = /\p{Lowercase_Letter}/giu;
const re2 = /[^\p{lowercase_letter}]/giu;
```

ç¬¬ä¸€ä¸ªæ¨¡å¼åŒ¹é…æ‰€æœ‰å°å†™å­—æ¯ã€‚ç¬¬äºŒä¸ªæ¨¡å¼ä½¿ç”¨ `\P` ä»£æ›¿ `\p` æ¥åŒ¹é…æ‰€æœ‰é™¤äº†å°å†™å­—æ¯ä»¥å¤–çš„æ‰€æœ‰å­—ç¬¦ï¼Œ
ä½†æ˜¯ç´§æ¥ç€åŒ…åœ¨ä¸€ä¸ªå¦å®šå­—ç¬¦ç±»ä¸­ï¼ˆ`[^...]`ï¼‰ã€‚é€šè¿‡è®¾ç½® `i` æ ‡å¿—ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œè¿™ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼éƒ½å˜å¾—ä¸åŒºåˆ†å¤§å°å†™ã€‚

ç›´è§‚åœ°ï¼Œä½ å¯èƒ½æœŸæœ›ä¸¤ä¸ªæ•´ä¸ªè¡¨è¾¾å¼æœ‰åŒæ ·çš„è¡Œä¸ºã€‚å®é™…ä¸Šï¼Œä»–ä»¬çš„è¡Œä¸ºéå¸¸ä¸åŒï¼š

```ts
const string = "aAbBcC4#";

string.replaceAll(re1, "X");
// â†’ 'XXXXXX4#'

string.replaceAll(re2, "X");
// â†’ 'aAbBcC4#''
```

æ–°çš„ `v` æ ‡å¿—æ²¡æœ‰ä»¤äººæƒŠè®¶çš„è¡Œä¸ºã€‚ç”¨ `v` æ ‡å¿—ä»£æ›¿ `u` æ ‡å¿—ã€‚ä¸¤ç§æ¨¡å¼çš„è¡Œä¸ºä¸€è‡´ï¼š

```ts
const re1 = /\p{Lowercase_Letter}/giv;
const re2 = /[^\p{lowercase_letter}]/giv;

const string = "aAbBcC4#";

string.replaceAll(re1, "X");
// â†’ 'XXXXXX4#'

string.replaceAll(re2, "X");
// â†’ 'XXXXXX4#'
```

æ›´æ™®éçš„è¯´ï¼Œæ— è®ºæ˜¯å¦è®¾ç½® `i` æ ‡å¿—ï¼Œ`v` æ ‡è®°éƒ½è®© `[^\p{x}]` â‰ `[\P{X}]` â‰ `\P{X}` è€Œä¸”è®© `[^\p{x}]` â‰ `[\p{X}]` â‰ `\p{X}`ã€‚

# æ‰©å±•é˜…è¯»

[ææ¡ˆä»“åº“](https://github.com/tc39/proposal-regexp-v-flag)åŒ…å«æ›´å¤šå…³äºè¿™äº›ç‰¹æ€§å’Œè®¾è®¡å†³ç­–çš„ç»†èŠ‚å’ŒèƒŒæ™¯ã€‚

ä½œä¸ºæˆ‘ä»¬åœ¨è¿™äº› JavaScript åŠŸèƒ½ä¸Šå·¥ä½œçš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘è¶…è¶Šäº†â€œä»…ä»…â€æè®®å¯¹ ECMAScript è§„èŒƒè¿›è¡Œæ›´æ”¹ã€‚æˆ‘ä»¬å°†â€œå­—ç¬¦ä¸²å±æ€§â€çš„å®šä¹‰
å‡çº§åˆ°äº† [Unicode UTS#18](https://unicode.org/reports/tr18/#Notation_for_Properties_of_Strings)ï¼Œä»¥ä¾¿å…¶ä»–
ç¼–ç¨‹è¯­è¨€å¯ä»¥ç»Ÿä¸€å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚æˆ‘ä»¬è¿˜ç»™ HTMl æ ‡å‡†æè®®è¿›è¡Œä¿®æ”¹ï¼Œç›®çš„æ˜¯åœ¨æ¨¡å¼å±æ€§ä¸­ä¹Ÿå¯ç”¨è¿™äº›åŠŸèƒ½ã€‚

[unicode mode]: https://mathiasbynens.be/notes/es6-unicode-regex
[sticky mode]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/sticky#description
[dotall mode]: https://mathiasbynens.be/notes/es-regexp-proposals#dotAll
[flags getter]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/flags
[lookbehind assertions]: https://mathiasbynens.be/notes/es-regexp-proposals#lookbehinds
[named capture groups]: https://mathiasbynens.be/notes/es-regexp-proposals#named-capture-groups
[unicode escapes]: https://mathiasbynens.be/notes/es-unicode-property-escapes
[match all]: https://v8.dev/features/string-matchall
[regexp v proposal]: https://github.com/tc39/proposal-regexp-v-flag
[properties of strings]: https://www.unicode.org/reports/tr18/#domain_of_properties
[proposal regexp v flag]: https://github.com/tc39/proposal-regexp-v-flag/issues/49
